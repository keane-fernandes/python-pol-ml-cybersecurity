local p_servicelayer_header = Proto ("service_layer_header", "Service Message Header")
p_servicelayer_header.fields = {}
p_servicelayer_header.fields.signature = ProtoField.bytes ("signature", "signature")
p_servicelayer_header.fields.timestamp = ProtoField.uint64 ("timestamp", "timestamp", base.DEC)
p_servicelayer_header.fields.sequenceNumber = ProtoField.uint32 ("sequenceNumber", "sequenceNumber", base.DEC)
p_servicelayer_header.fields.serviceType = ProtoField.uint32 ("serviceType", "serviceType", base.DEC)
p_servicelayer_header.fields.pid = ProtoField.uint32 ("pid", "pid", base.DEC)
p_servicelayer_header.fields.sid = ProtoField.uint32 ("sid", "sid", base.DEC)
p_servicelayer_header.fields.iid = ProtoField.uint32 ("iid", "iid", base.DEC)
p_servicelayer_header.fields.vid = ProtoField.uint32 ("vid", "vid", base.DEC)
p_servicelayer_header.fields.messageSize = ProtoField.uint32 ("messageSize", "messageSize", base.DEC)
p_servicelayer_header.fields.flags = ProtoField.uint32 ("flags", "flags", base.DEC)
p_servicelayer_header.fields.interfaceQos = ProtoField.uint32 ("interfaceQos", "interfaceQos", base.DEC)
p_servicelayer_header.fields.reservedPaddingFor8ByteAlignment1 = ProtoField.uint32 ("reservedPaddingFor8ByteAlignment1", "reservedPaddingFor8ByteAlignment1", base.DEC)
p_servicelayer_header.fields.reservedPaddingFor8ByteAlignment2 = ProtoField.uint32 ("reservedPaddingFor8ByteAlignment2", "reservedPaddingFor8ByteAlignment2", base.DEC)
p_servicelayer_header.fields.reservedPaddingFor8ByteAlignment3 = ProtoField.uint32 ("reservedPaddingFor8ByteAlignment3", "reservedPaddingFor8ByteAlignment3", base.DEC)

function p_servicelayer_header.dissector (buf, pinfo, tree)
    local header_size = 56
    local subtree = tree:add (p_servicelayer_header, buf (0, header_size))
    subtree:add (p_servicelayer_header.fields.signature, buf (0, 16))
    subtree:add (p_servicelayer_header.fields.timestamp, buf (16, 8))
    subtree:add (p_servicelayer_header.fields.sequenceNumber, buf (24, 4))
    subtree:add (p_servicelayer_header.fields.serviceType, buf (28, 4))
    subtree:add (p_servicelayer_header.fields.pid, buf (32, 4))
    subtree:add (p_servicelayer_header.fields.sid, buf (36, 4))
    subtree:add (p_servicelayer_header.fields.iid, buf (40, 4))
    subtree:add (p_servicelayer_header.fields.vid, buf (44, 4))
    subtree:add (p_servicelayer_header.fields.messageSize, buf (48, 2))
    subtree:add (p_servicelayer_header.fields.flags, buf (50, 2))
    subtree:add (p_servicelayer_header.fields.interfaceQos, buf (52, 1))
    subtree:add (p_servicelayer_header.fields.reservedPaddingFor8ByteAlignment1, buf (53, 1))
    subtree:add (p_servicelayer_header.fields.reservedPaddingFor8ByteAlignment2, buf (54, 1))
    subtree:add (p_servicelayer_header.fields.reservedPaddingFor8ByteAlignment3, buf (55, 1))
end
